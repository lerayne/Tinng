<!DOCTYPE HTML>
<html>
<head>
	<title>Class constructor</title>
	<script type="text/javascript" src='../libraries/jquery-1.7.2.min.js'></script>
	<script type="text/javascript">

		if (typeof(liveboard) == 'undefined') liveboard = {};


		liveboard.Class = function (definition) {

			var Class = this;

			var constructor = function () {

				var that = this;

				this.$ = {};

				if (typeof this.definition.base == 'function') {
					// наследуем имеющийся класс


				} else {
					// создаем новый класс


				}

				if (typeof this.definition.members == 'object') {

					var key, member;
					for (key in this.definition.members) Class.parseMembers.call(that, this.definition.members[key], key)
				}
			}

			constructor.prototype.definition = definition;

			return constructor;
		}


		liveboard.Class.METHOD_MEMBER = 'METHOD_MEMBER';
		liveboard.Class.PROPERTY_MEMBER = 'PROPERTY_MEMBER';
		liveboard.Class.PUBLIC_ACCESS = 'PUBLIC_ACCESS';
		liveboard.Class.PRIVATE_ACCESS = 'PRIVATE_ACCESS';


		liveboard.Class.prototype = {
			parseMembers:function (member, key) {

				if (member.type == 'METHOD_MEMBER' && typeof member.method == 'function') {
					if (member.access == 'PUBLIC_ACCESS') {
						this[key] = member.method;
					} else if (member.access == 'PRIVATE_ACCESS') {
						this.$[key] = function () {
							console.log(member);
							member.method.apply(this, arguments);
						}
					} else {
						throw 'method access error: expected PUBLIC_ACCESS or PRIVATE_ACCESS';
					}
				}

				if (member.type == 'PROPERTY_MEMBER' && typeof member.getter == 'function' && typeof member.setter == 'function') {
					if (member.access == 'PUBLIC_ACCESS') {
						this.__defineGetter__(key, member.getter);
						this.__defineSetter__(key, member.setter);
					} else if (member.access == 'PRIVATE_ACCESS') {

					} else {
						throw 'property access error: expected PUBLIC_ACCESS or PRIVATE_ACCESS';
					}
				}
			}
		}


		var Control = new liveboard.Class({

		});


		var Form = new liveboard.Class({
			'base':Control,

			'members':{

				'onSaveClick':{
					'type':liveboard.Class.METHOD_MEMBER, // = 'METHOD_MEMBER'
					'access':liveboard.Class.PUBLIC_ACCESS,
					'method':function () {

					}
				},


				somePrivateFunc:{
					type:liveboard.Class.METHOD_MEMBER,
					access:liveboard.Class.PRIVATE_ACCESS,
					method:function () {
						console.log(this.text);
					}
				},

				somePrivateFunc2:{
					type:liveboard.Class.METHOD_MEMBER,
					access:liveboard.Class.PRIVATE_ACCESS,
					method:function () {
						console.log(this.text + 'aaa');
					}
				},


				'text':{
					'type':liveboard.Class.PROPERTY_MEMBER,
					'access':liveboard.Class.PUBLIC_ACCESS,
					'getter':function () {
						return this.$.text;
					},
					'setter':function (value) {
						this.$.text = value;
					}
				}
			},

			'initialize':function () {
				this.content = [
					{
						//'class' : Button,
						'text':'Сохранить',
						'click':'onSaveClick'
					}
				];
			}
		});

		var form = new Form();

		console.log('here goes the [form]')
		console.log(form);

		form.text = 'test';

	</script>
</head>
<body>

</body>
</html>